var currentConfirmEL,errors,comparePage=!1,mainPage=!1,purchasingPage=!1,mainFormPage=1,mainFormTravelers=1,finalPaymentEnabled=!0,confirmObj={},modalConfirmed=!1;$("main").hasClass("comparePage")&&(comparePage=!0),$("main").hasClass("mainPage")&&(mainPage=!0),$("main").hasClass("purchasing")&&(purchasingPage=!0);var mAgeNotSet="Please enter all travelers ages as of today. For infants under the age of 1 you may enter 0",mServerNotRespond="Server communication failure. Please refresh your browser and try again",mTripCostNotNumber='Wrong "Trip Cost" value<br>Only numbers are allowed',mTripCostTooBig="Trip cost exceeds maximum possible coverage",mAgeNotNumber='Wrong "Age" value<br>Only numbers are allowed',mAgeTooBig='Wrong "Age" value<br>No more than a three-digit number allowed';function resizeDiv(){const e=window.innerWidth,t=$(".forminfo").outerHeight();$(".travelform").css({height:t+"px"}),$(".travelform .pattern").css({height:t+"px"}),$("#hero-inner").css({height:t+"px"}),$(".slogan-box").css({height:t+"px"}),$(".forminfo-box").css({height:t+"px"}),e<992?$(".benefits").css({"margin-top":t+10+"px"}):$(".benefits").css({"margin-top":"0px"})}window.onresize=function(e){resizeDiv(),comparePage&&updateFS()},window.onchange=(e=>{comparePage&&updateFS()}),$(".forminfo").on("change",()=>{setTimeout(resizeDiv)}),$(".burgerbtn").click(function(){$(".side-menu").fadeIn("fast")}),$(".crossbtn").click(function(){$(".side-menu").fadeOut("fast")});var originalLeave=$.fn.tooltip.Constructor.prototype.leave;function updTopBlockSize(){if($(window).width()>900){var e=$(".summary .results").height();$(".summary .results").css({bottom:-e}),$(".fake-results").css({height:e})}}function updateSelectedCheckBox(e){var t=e.attr("data-text"),a=e.attr("data-name"),o=$(".checkbox-filter:checkbox:checked").length;if(1==e.prop("checked")){var r='<div class="filter-tag alert fade in" name="'+a+'"><span>'+t+'</span><a class="close" name="'+a+'" onclick="remove_tag(\''+a+"');\" >×</a></div>";$(".counter_div").append(r)}else $(".filter-tag[name='"+a+"']").remove();$("#counter_text").text(o),0==o?$("#selected-checkboxes").hide():$("#selected-checkboxes").show(),updTopBlockSize()}function updateCounter(){var e=$(".checkbox-filter:checkbox:checked").length;$("#counter_text").text(e),0==e?$("#selected-checkboxes").hide():$("#selected-checkboxes").show()}function remove_tag(e){$('input[data-name="'+e+'"]').click(),updTopBlockSize()}function registryDetailsExpand(){$(".table-subhead").click(function(){$(this).toggleClass("expand").nextUntil("tr.table-subhead").slideToggle(100)})}if($.fn.tooltip.Constructor.prototype.leave=function(e){var t,a,o=e instanceof this.constructor?e:$(e.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);originalLeave.call(this,e),e.currentTarget&&(t=$(e.currentTarget).siblings(".tooltip"),a=o.timeout,t.one("mouseenter",function(){clearTimeout(a),t.one("mouseleave",function(){$.fn.tooltip.Constructor.prototype.leave.call(o,o)})}))},$("body .plans-travelers").tooltip({selector:"[data-toggle]",trigger:"hover",placement:"top auto",delay:{show:50,hide:400},html:!0,title:"This is the age that was entered on the quote form. If this is incorrect, please go back and quote again"}),$(window).width()<992?($(".state").attr("title","Select a State…"),$(".expir-mth").attr("title","Month..."),$(".expir-y").attr("title","Year..."),$):($(".state").attr("title","Select a State/Province/Territory"),$(".expir-mth").attr("title","Month"),$(".expir-y").attr("title","Year")),$(".filter-name").click(function(){var e=$(this).attr("data-block");"false"==$(this).attr("closed")?($(".filter-expand[data-block='"+e+"']").slideToggle("fast"),$(".filter-expand[data-block='"+e+"']").attr("closed",!0),$(".chevron-open[data-block='"+e+"']").attr("closed",!0),$(".chevron-open[data-block='"+e+"']").removeClass("chevron-open").addClass("chevron-close"),$(this).attr("closed",!0)):($(".filter-expand[data-block='"+e+"']").slideToggle("fast"),$(".filter-expand[data-block='"+e+"']").attr("closed",!1),$(".chevron-close[data-block='"+e+"']").attr("closed",!1),$(".chevron-close[data-block='"+e+"']").removeClass("chevron-close").addClass("chevron-open"),$(this).attr("closed",!1)),updTopBlockSize(),setTimeout(function(){updateSticky(!1)},210)}),registryDetailsExpand(),$("#btn-collapse-wrapper").css("visibility","hidden"),$(window).width()>767){var timeoutDrag,sidebarW,filtersButtonW,visible=!1;$(".divfixed-wrapper").hasClass("divfixed")&&$(".divfixed-wrapper").removeClass("divfixed");var fakeScroll=$(".fScrollCont");$(".scrlCont").scroll(function(e){var t=$(".scrlCont").scrollLeft();clearTimeout(timeoutDrag),timeoutDrag=setTimeout(function(){var e=$(".scrlCont").scrollLeft();console.log("horizontal scroll"),fakeScroll.scrollLeft(e),sTable.$stickyTableColumn.is(":hidden")?stickyItem.css("margin-left",$(".fContFake").offset().left):stickyItem.css("margin-left",0)},100),t>sidebarW-filtersButtonW&&!visible&&($("#btn-collapse-wrapper").css("visibility","visible").addClass("showed"),visible=!0),t<sidebarW-filtersButtonW&&visible&&($("#btn-collapse-wrapper").css("visibility","hidden").removeClass("showed"),visible=!1)}),$(".btn-collapse").click(function(){$(".scrlCont").animate({scrollLeft:0}),$("#mCSB_1_dragger_horizontal, #mCSB_1_container").animate({left:0})}),$(fakeScroll).scroll(function(e){var t=fakeScroll.scrollLeft();$(".scrlCont").scrollLeft(t)})}var formValues=JSON.parse(localStorage.getItem("formValues"))||{},$checkboxes=$("#fcompare :checkbox");function handleButtonClick(){$checkboxes.prop("checked",!1)}function updateFS(){sidebarW=$(".filters").outerWidth(),filtersButtonW=$("#btn-collapse-wrapper").width();var e=$(".scrlCont")[0].scrollWidth;$(".fContFake").width(e)}function validateEmail(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}function setNotValid(e){e.parents(".input-group").addClass("notValid"),e.parents(".btn-group").find(".btn").addClass("notValid")}function ValidatePurchasingForm(){errors=!1;var e=$(".plans").find("select, input");$(".plans .notValid").removeClass("notValid"),e.each(function(e,t){var a=$(t);0!==a.parents(".form-group:first").find("label req").length&&0===a.val().length&&"disabled"!=a.attr("disabled")&&(a.parents(".input-group").addClass("notValid"),a.parents(".btn-group").find(".btn").addClass("notValid"),"text"==a.attr("type")&&0===a.parents(".input-group").length&&a.addClass("notValid"))}),validateEmail($("#clientEmail").val())||($("#clientEmail").addClass("notValid"),errors=!0);var t=!0;if($("#triptype input").each(function(e,a){!0===a.checked&&(t=!1)}),t&&($("#triptype").addClass("notValid"),errors=!0),0!=$("#state").val().length&&$("#state").parents(".form-group").find(".notValid").removeClass("notValid"),0!=$("#country").val().length&&$("#country").parents(".form-group").find(".notValid").removeClass("notValid"),0!=$("#state2").val().length&&$("#state2").parents(".form-group").find(".notValid").removeClass("notValid"),0!=$("#country2").val().length&&$("#country2").parents(".form-group").find(".notValid").removeClass("notValid"),0!=$("#expMonth").val().length&&$("#expMonth").parents(".form-group").find(".notValid").removeClass("notValid"),0!=$("#expYear").val().length&&$("#expYear").parents(".form-group").find(".notValid").removeClass("notValid"),$("#agreeTerms")[0].checked||$(".final-price label").addClass("notValid"),errors||$(".plans .notValid").length>0){var a=$(".plans .notValid:first");$("html, body").stop().animate({scrollTop:a.offset().top-90},"500","swing",function(){showModal({title:"Check fields",text:"Please complete all required fields!",type:"error",fontSize:19})})}else showModal({title:"Validation complete",text:"Sending data to server, wait for confirmation",type:"info"})}function ValidateMainForm(e){errors=!1;var t=!1;if(mainFormPage>e)setMainFormPage(e);else{var a=$("form.active").find("select, input");$("form.active .notValid").removeClass("notValid"),a.each(function(e,t){var a=$(t);if(void 0!==a.attr("id")&&0===a.val().length&&"disabled"!=a.attr("disabled")){if("tripCost"==a.attr("id"))return;a.parents(".input-group").addClass("notValid"),a.parents(".btn-group").find(".btn").addClass("notValid"),errors=!0}}),a.each(function(e,a){var o=$(a);if(void 0!==o.attr("id")){if(console.log(o),o.hasClass("ddown")&&0===o.val().length&&"disabled"!=o.attr("disabled"))return o.parents(".btn-group").find(".dropdown-toggle").dropdown("toggle"),!1;if(o.hasClass("dateSel")&&0===o.val().length)return o.parent().data("DateTimePicker").show(),!1;if(o.hasClass("numeric")){if("tripCost"==o.attr("id")){if(0===o.val().length||0==o.val()){if(currentConfirmEL=o,null!=confirmObj[o.attr("id")])return;return showModal({title:"Check fields",text:mTripCostNotSet,type:"error",fontSize:18,confirm:!0}),t=!0,!1}if(o.val()>1e6)return showModal({title:"Check fields",text:mTripCostTooBig,type:"error",fontSize:18}),errors=!0,setNotValid(o),!1}if("age"==o.attr("id").split("-")[0]){if(0===o.val().length)return showModal({title:"Check fields",text:mAgeNotSet,type:"error",fontSize:18}),errors=!0,!1;if(o.val().length>3)return showModal({title:"Check fields",text:mAgeTooBig,type:"error",fontSize:18}),errors=!0,setNotValid(o),!1}}}});var o=$("#dapartureDate").val(),r=$("#returnDate").val();errors||t||moment(r,"DD-MM-YYYY").unix()-moment(o,"DD-MM-YYYY").unix()!=86400?!errors&&t&&moment(r,"DD-MM-YYYY").unix()-moment(o,"DD-MM-YYYY").unix()==86400&&(errors=!0):(currentConfirmEL=$("#dapartureDate"),null==confirmObj[currentConfirmEL.attr("id")]&&(showModal({title:"Check fields",text:mOneDayDiff,type:"error",fontSize:18,confirm:!0}),t=!0)),errors||t||setMainFormPage(e)}}$(document).ready(function(){comparePage&&(setTimeout(function(){$(".pTotal").html($(".table-non-sticky .price p.total").html()),$(".sticky-header .alt-provname, .alt-plan-name").ellipsis({setTitle:"onEllipsis",live:!1})},200),$.each(formValues,function(e,t){$("#"+e).prop("checked",t);var a=$("#"+e);if(!0===t){var o=a.attr("text"),r=a.attr("name"),i=$(".checkbox-filter:checkbox:checked").length,n='<div class="filter-tag alert fade in" name="'+r+'"><span>'+o+'</span><a class="close" name="'+r+'" onclick="remove_tag(\''+r+"');\" >×</a></div>";$(".counter_div").append(n),$("#counter_text").text(i),0==i?$("#selected-checkboxes").hide():$("#selected-checkboxes").show()}updTopBlockSize()}))}),$(window).on("load",function(){resizeDiv(),$(document).on("click","dropdown-menu",function(e){e.stopPropagation()}),comparePage&&updateFS(),mainPage&&$(".bootstrap-select").on("hidden.bs.dropdown",function(e){var t=$(e.target).children().attr("data-id");switch(console.log(t),t){case"travelers":updateTravelers()}}),$(document).on("click","#notfback .close",function(){resizeDiv()}),$(document).on("keydown","input.numeric",function(e){-1!==$.inArray(e.keyCode,[46,8,9,27,13,110,190])||65==e.keyCode&&!0===e.ctrlKey||67==e.keyCode&&!0===e.ctrlKey||88==e.keyCode&&!0===e.ctrlKey||e.keyCode>=35&&e.keyCode<=39||(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()}),$(document).on("keydown","input.ageordate",function(e){var t=e.keyCode;if(!(-1!==$.inArray(t,[46,8,9,27,13,110])||65==t&&!0===e.ctrlKey||86==t&&!0===e.ctrlKey||67==t&&!0===e.ctrlKey||88==t&&!0===e.ctrlKey||t>=35&&t<=39||191===t)){var a=e.key;"1"!==a&&"2"!==a&&"3"!==a&&"4"!==a&&"5"!==a&&"6"!==a&&"7"!==a&&"8"!==a&&"9"!==a&&"0"!==a&&"/"!==a&&"."!==a&&e.preventDefault()}}),$(document).on("change keyup paste","input.ageordate",function(){var e=this.value;if(e.match(/^[0-9./\\]*$/)){e=e.split(".").join("/"),this.value=e;var t=e.length;if(t>0){var a=e.substr(t-1),o=e.substring(0,t-1),r=o.length;if(r>0)var i=o.substring(0,1),n=o.substr(r-1);var l=o.includes("/");"/"===a?0===r||"0"===o||"/"===n||r>5||3===r&&!l||4===r&&!l&&0===n?this.value=o:1===r?this.value="0"+e:4===r&&l&&(this.value=o.substring(0,3)+"0"+n+a):"0"===a?"0"===o||5===r||6===r||3===r&&!l&&"0"===n||4===r&&l&&"0"===n?this.value=o:2===r&&"0"===i?this.value=o+"/"+a:3!==r||l?4===r&&l&&(this.value=e):this.value=e.substring(0,2)+"/"+e.substring(2):3!==r||l?7!==r||l?(2===r&&"0"===i||5===r)&&(this.value=o+"/"+a):this.value=e.substring(0,2)+"/"+e.substring(2,4)+"/"+e.substring(4):this.value=e.substring(0,2)+"/"+e.substring(2)}}else this.value=""})});